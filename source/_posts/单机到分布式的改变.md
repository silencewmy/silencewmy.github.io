---
title: 单机到分布式的变化
date: 2019-03-10 10:42:42
tags: [中间件,架构]
categories: 技术
---


单机与分布式的区别


<!--more-->

分布式系统的意义：组件分布在网络计算机上，组件之间仅通过消息传递来通信兵协调工作。

多进程模式：多个进程之间的内存空间是相互独立的，多进程共享数据设计到序列化和反序列化。

组成计算机的5个要素：输入设备、输出设备、运算器、控制器、存储器。
将应用从单机扩展到分布式：

要素 | 分布式 | 单机
:---:|:------:|:----:
输入设备	| 	接受其它节点信息的节点	| 	传统的人机交互设备
输出设备	|	向其它节点传递消息时的节点	|	传统人机交互设备
控制器变化	|	在分布式中改为控制方式，作用为：协调或者控制节点之间的动作和行为，换句话说就是决定由谁来处理请求	|	单机中的控制器
运算器变化	|	有多个节点来组成，构成运算器的多个节点在控制器的配合下对外提供服务	|	单机的运算器
存储器的变化	|	分布式中的存储需要控制器配合使用	|	单机中的存储器

控制器的变化补充： **如何实现节点间的配对**

- 硬件负载均衡：系统中的所有请求都要经过该应硬件设备，硬件负载将数据分流转发，类似于路由器的转发。
- 软件负载：LVS透明代理。服务的消费者和生产者只需要知道中间代理的地址就可以进行节点间的服务的使用。通过LVS透明代理，让请求方认为是中间代理完成了请求的处理。让处理方认为是中间代理进行的请求。所以请求方与处理方不需要知道彼此的地址就可以进行交流。 **软件负载具有如下的缺点**：
    + 在请求的必经之路上增加了网络的开销。
    + 因为是请求方与处理方彼此透明，通过中间代理进行交流。中间的代理就是枢纽，作用无可代替，因此需要保证无差错的运行。
- 使用名称服务器的直连来发现相对的节点：地址交换的作用类似于DNS服务器的发现方式。请求方将需要的服务发送给名称服务器，服务器将提供该服务的所有的服务器地址发送给请求方。
- 采用规则服务器发送控制路由的直连调用：方式与名称服务器类似，不同在于在接受到服务请求后，规则服务器将选择处理器的规则发送给请求方。 看到一个推荐，虽然不太明白。更多运用在有状态的场景中，例如数据或者缓存。猜测可能是根据不同的请求内容有不同的规则来进行分等级处理或者什么分区域。
- 任务的分配和管理：分为两个角色
    + master：管理任务，由master将任务分配给不同的worker进行处理
    + worker：任务处理。



分布式系统的难点：

- 缺乏全局时钟，解决为关注动作的相对次序，不在根据准确的时间。
- 故障独立性：指的是整个系统中的一部分存在故障问题，而其他设备正常。
- 单点故障：单点的定义为（某个角色或者某个功能只有一台机器在支撑）。解决方式为：
    + 给单点做好备份，尽量降低自动恢复的时间
    + 降低故障的影响范围
- 事务处理


